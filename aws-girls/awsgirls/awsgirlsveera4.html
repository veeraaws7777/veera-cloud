<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Girls Sandbox Dashboard</title>
    <link rel="icon" type="image/png" href="https://static.vecteezy.com/system/resources/thumbnails/045/720/728/small_2x/dark-cat-head-free-png.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0f0b29;
            --panel-bg: #1c183d;
            --border-color: #3d3763;
            --text-main: #ffffff;
            --text-dim: #b5b3c5;
            --accent-purple: #5c4ee5;
            --accent-pink: #d81b60;
            --btn-hover: #4a3dbd;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 40px 20px;
            display: flex;
            justify-content: center;
        }

        .sandbox-container {
            width: 100%;
            max-width: 1100px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .aws-logo-box {
            background: #f7941e;
            padding: 10px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .aws-logo-box i { font-size: 40px; color: white; }

        h1 { margin: 0; font-size: 24px; font-weight: 600; }

        .incognito-hint { 
            color: var(--text-dim); 
            font-size: 14px; 
            margin-top: 5px; 
        }

        /* Added styles for user-details-box */
        .user-details-box {
            background: #222044;
            color: #fff;
            border: 1px solid #3d3763;
            padding: 13px 20px 13px 20px;
            border-radius: 7px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            font-size: 15px;
            min-width: 130px;
            min-height: 26px;
            box-shadow: 0 2px 8px rgba(32,16,70,0.08);
        }
        .user-details-box .user-name {
            font-weight: 600;
            font-size: 15.5px;
            color: #fae989;
            margin-bottom: 2px;
        }
        .user-details-box .user-email {
            font-size: 13px;
            color: #b5b3c5;
            margin-bottom: 2px;
        }
        .user-details-box .user-role {
            font-size: 12.5px;
            padding: 2px 7px;
            border-radius: 12px;
            background: #5c4ee5;
            color: #fff;
            margin-top: 4px;
            display: inline-block;
        }

        .close-btn {
            display: none !important; /* Hide the original button just in case */
        }

        /* Main Panel Wrapper */
        .main-panel {
            background: var(--panel-bg);
            border-radius: 12px;
            padding: 30px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.25);
            padding: 15px 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .delete-btn {
            background: transparent;
            border: 1px solid var(--accent-pink);
            color: white;
            padding: 10px 18px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 12px;
            transition: 0.3s;
        }

        .delete-btn:hover { background: rgba(216, 27, 96, 0.1); }

        .open-btn {
            background: var(--accent-purple);
            border: none;
            color: white;
            padding: 11px 22px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .open-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .url-section label { 
            display: block; 
            font-size: 12px; 
            color: var(--text-dim); 
            margin-bottom: 4px; 
        }

        .copy-box {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: monospace;
            color: var(--text-dim);
        }

        .status-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .status-bar i { color: var(--text-dim); }

        .content-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 40px;
        }

        .inputs-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .input-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .field-container {
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            display: flex;
            align-items: center;
            padding: 12px 15px;
        }

        .field-container input {
            background: transparent;
            border: none;
            color: white;
            width: 100%;
            outline: none;
            font-size: 15px;
        }

        .field-container i {
            color: var(--text-dim);
            cursor: pointer;
            transition: 0.2s;
        }
        .field-container i:hover { color: white; }

        .info-card {
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            padding: 25px;
            height: fit-content;
        }

        .info-card h3 { 
            margin-top: 0; 
            font-size: 16px; 
            line-height: 1.4; 
            margin-bottom: 15px;
        }

        .info-card p { 
            font-size: 13.5px; 
            color: var(--text-dim); 
            line-height: 1.6; 
            margin-bottom: 20px;
        }

        .info-card a { 
            color: var(--text-dim); 
            font-size: 13px; 
            text-decoration: underline; 
        }

        .help-fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--accent-pink);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 15px rgba(216, 27, 96, 0.4);
            cursor: pointer;
        }
        
        /* Access Restriction Modal Styles */
        #access-restrict-modal {
            display:none;
            position:fixed;
            top:0;left:0;right:0;bottom:0;
            background:rgba(20,10,50,0.92);
            z-index:10001;
            justify-content:center;
            align-items:center;
        }
        #access-restrict-modal .modal-content {
            background: #241f4c;
            color: white;
            border-radius: 14px;
            max-width: 400px;
            width: 90%;
            padding: 32px 20px 24px 20px;
            box-shadow:0 5px 40px 0 rgba(0,0,0,0.4);
            position:relative;
            text-align: center;
            font-size: 20px;
        }
        #access-restrict-modal i {
            color: #ffde59;
            font-size: 36px;
            margin-bottom: 18px;
        }

        /* Notification Box */
        #notify-box {
            position: fixed;
            top: 20px;
            right: -400px;
            width: 320px;
            background: #111827;
            border-radius: 14px;
            padding: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            transition: all 0.6s ease;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
        }

        #notify-box.show {
            right: 40px;
            opacity: 1;
            pointer-events: auto;
        }

        #notify-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .notify-item {
            background: #1f2937;
            padding: 10px;
            border-radius: 8px;
        }
    </style>

    <!-- Pusher -->
    <script src="https://js.pusher.com/8.4.0/pusher.min.js"></script>

</head>
<body>

    <div class="sandbox-container">
        <header class="header">
            <div class="logo-section">
                <div class="aws-logo-box">
                    <i class="fab fa-aws"></i>
                </div>
                <div>
                    <h1>AWS Girls Sandbox</h1>
                </div>
            </div>
            <div id="user-details" class="user-details-box" style="min-width:130px;min-height:26px;">
                Loading user...
            </div>
        </header>

        <div class="main-panel">
            <div class="action-bar">
                <div class="btn-group">
                    <button class="delete-btn" id="btn-delete"><i class="fas fa-trash-alt"></i> Delete Sandbox</button>
                    <button class="open-btn" id="btn-open">Open Sandbox</button>
                </div>
                <div class="url-section">
                    <label>Sandbox URL</label>
                    <div class="copy-box">




                        <span id="url-val" style="user-select: all;">https://150965600868.signin.aws.amazon.com/console?region=us-east-1</span>





                    </div>
                </div>
            </div>

            <div class="status-bar" id="status-bar">
                <i class="far fa-clock"></i>
                <span>
                    <strong>Usage Window</strong>: <b>09:00 AM</b> to <b>06:00 PM</b>. Access is only allowed during this time period.
                </span>
            </div>
            <div style="background: #fff3cd; color: #856404; border: 1px solid #ffeeba; border-radius: 6px; padding: 9px 15px; margin: 12px 0; font-size: 15px; display: flex; align-items: center; gap: 9px;">
                <i class="fas fa-exclamation-triangle" style="color:#e0a800"></i>
                <span>
                    <strong>Warning:</strong> Your usage is being monitored. If any suspicious activities are detected, your access will be removed.
                </span>
            </div>
            <br><br>

            <div class="content-layout">
                <div class="inputs-grid">
                    <div class="input-group">
                        <label for="user">Username <i class="far fa-question-circle" title="Your AWS IAM username"></i></label>
                        <div class="field-container">
                            <input type="text" value="cloud_user" id="user" readonly>
                            <i class="far fa-copy" data-copy-target="user" title="Copy Username"></i>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="pass">Password <i class="far fa-question-circle" title="Your AWS IAM password"></i></label>
                        <div class="field-container">
                            <input type="password"



                            
                            value="3f]NH)h615XTLebt=l]T" 
                            
                            
                            
                            id="pass" readonly>
                            <i class="far fa-eye" data-toggle-pass="pass" title="Show/Hide Password"></i>
                            <i class="far fa-copy" data-copy-target="pass" style="margin-left:6px;" title="Copy Password"></i>
                        </div>
                    </div>
                </div>
                <div style="background: rgba(255,243,205,0.45); border: 1px solid #ffeeba; border-radius: 8px; padding: 14px 19px 12px 19px; margin: 15px 0 18px 0; color: #000; font-size: 15.5px; box-shadow: 0 2px 8px 0 rgba(179,0,89,0.05); display: flex; align-items: flex-start; gap: 10px;">
                    <i class="fas fa-exclamation-triangle" style="color: #e0a800; font-size: 21px; margin-top: 2px;"></i>
                    <div>
                        <span style="font-weight: 600;">Warning:</span>
                        You are only allowed to create up to <b>9 instances</b>. 
                        Each instance name <b>must include your name</b> as part of its name.
                    </div>
                </div>

                <ul style="margin-bottom: 18px; padding-left: 18px;">
                  <li style="margin-top:9px;">
                    <b>Region Usage Policy:</b> Resources may only be created or used in the enabled regions listed below. Attempts outside these regions will be blocked. You are limited to a maximum of <strong>9 instances</strong>.
                  </li>
                  <li style="margin-top:9px;">
                    <b>Billing and Resource Limits:</b> Usage of high-cost resources is closely monitored and may be restricted or terminated at any time without notice. Please monitor your usage thoughtfully.
                  </li>
                  <li style="margin-top:9px;">
                    <b>Session Monitoring:</b> All actions are monitored and logged to ensure compliance with sandbox policies.
                  </li>
                </ul>
                <div style="background: rgba(227,247,252,0.38); border: 1px solid #0e2a42; border-radius: 8px; padding: 18px 20px 13px 20px; margin: 18px 0 18px 0; color: #111; font-size: 16px; box-shadow: 0 2px 8px 0 rgba(0,27,55,0.02);">
                  <div style="font-weight: 600; color: #11325a; font-size: 17px; margin-bottom: 8px;">
                      Region Access Restriction
                  </div>
                  <div>
                      You are only allowed to access the following AWS regions from this sandbox:
                      <ul style="margin:9px 0 0 19px; padding-left:0; list-style: disc;">
                          <li><strong>N. Virginia</strong> &rarr; <code>us-east-1</code></li>
                          <li><strong>Oregon</strong> &rarr; <code>us-west-2</code></li>
                      </ul>
                  </div>
                </div>

                <aside class="info-card">
                    <h3>Extend Your Session</h3>
                    <p>Your sandbox will automatically expire 4 hours after your start time. If you need to extend your session, you will receive a notification when you have 1 hour remaining that will allow you to extend your sandbox session for an additional 4 hours.</p>
                    <a href="https://docs.aws.amazon.com/console/open-console-using-incognito" target="_blank" rel="noopener">Learn more about why this matters in our Knowledge base article.</a>
                </aside>
            </div>
        </div>
    </div>

    <div class="help-fab" id="help-fab" title="Open Help">
        <i class="fas fa-question" style="color: white; font-size: 20px;"></i>
    </div>

    <div id="access-restrict-modal">
        <div class="modal-content">
            <i class="fas fa-lock"></i><br>
            <b>Access Restricted</b>
            <div style="margin-top:14px;font-size:16px;">
                Sandbox access is allowed only between <b>09:00 AM</b> and <b>06:00 PM</b>.<br>
                Please return during access hours.
            </div>
        </div>
    </div>

    <div id="help-modal" style="
        display:none;
        position:fixed;
        top:0;left:0;right:0;bottom:0;
        background:rgba(20,10,50,0.92);
        z-index:10000;
        justify-content:center;
        align-items:center;
    ">
        <div style="
            background: #241f4c;
            color: white;
            border-radius: 14px;
            max-width: 350px;
            width: 90%;
            padding: 32px 20px 24px 20px;
            box-shadow:0 5px 40px 0 rgba(0,0,0,0.4);
            position:relative;
        ">
            <button onclick="document.getElementById('help-modal').style.display='none';" 
                style="position:absolute; right:18px; top:8px; background:transparent; border:none; color:#aaa;font-size:18px;cursor:pointer;">
                <i class="fas fa-times"></i>
            </button>
            <h2 style="margin-top:0;font-size:22px;">Help & FAQs</h2>
            <ul style="padding-left:18px;">
                <li>Use <strong>Incognito mode</strong> for AWS Sandbox to avoid cross-account issues.</li>
                <li>Click <i class="far fa-copy"></i> icons to copy credentials.</li>
                <li>You can <i class="far fa-eye"></i> to show/hide passwords.</li>
                <li>Use "Open Sandbox" to launch the AWS Console in a new tab.</li>
            </ul>
        </div>
    </div>

    <!-- Removed the "Click anywhere once to enable sound ðŸ””" h2 as per instruction -->
    <div id="notify-box">
      <div id="notify-title">ðŸ”” Notification</div>
      <div id="notify-list"></div>
    </div>
    <audio id="notify-sound" preload="auto">
      <source src="https://potential-yellow-h2kf4sbfiu.edgeone.app/Best%20Notification%20Tone.mp3" type="audio/mpeg">
    </audio>

    <script>
        // --- Time Access Restriction Logic ---
        (function() {
            // Allowed window: 09:00AM (9*60+0) to 6:00PM (18*60+0)
            var now = new Date();
            var mins = now.getHours() * 60 + now.getMinutes();
            var start = 9 * 60 + 0; // 9:00 AM
            var end = 18 * 60 + 0; // 6:00 PM

            if (mins < start || mins > end) {
                document.addEventListener('DOMContentLoaded',function() {
                    document.querySelector('.sandbox-container').style.filter="blur(2.5px)";
                    document.querySelector('.sandbox-container').style.pointerEvents="none";
                    document.getElementById("access-restrict-modal").style.display = "flex";
                });
            }
        })();

        // --- USER DETAIL LOADER from aws4/main.html ---
        document.addEventListener('DOMContentLoaded', function() {
            var userBox = document.getElementById('user-details');
            fetch('aws4/main.html', {credentials: 'include'})
                .then(function(response) {
                    if (!response.ok) throw new Error("User not found");
                    return response.text();
                })
                .then(function(htmltxt) {
                    var dom = document.createElement('div');
                    dom.innerHTML = htmltxt;

                    function findText(dom, match) {
                        match = match.toLowerCase();
                        const els = dom.querySelectorAll('*');
                        for (const el of els) {
                            if (el.innerText && el.innerText.toLowerCase().includes(match)) return el;
                        }
                        return null;
                    }

                    let name = '';
                    let email = '';
                    let role = '';

                    let userNameNode = dom.querySelector('[data-username], [data-user], #username, #user, .user, .username, .profile-name');
                    if (userNameNode && userNameNode.textContent.trim().length > 2) {
                        name = userNameNode.textContent.trim();
                    }

                    let emailNode = dom.querySelector('[href^="mailto:"], .email, #email, [data-email]');
                    if (emailNode) {
                        email = emailNode.textContent.trim();
                    } else {
                        let allNodes = dom.querySelectorAll('*');
                        for(let n of allNodes) {
                            let t = n.textContent || "";
                            if (t.includes('@') && t.length < 50) {
                                email = t.trim();
                                break;
                            }
                        }
                    }

                    let roleNode = dom.querySelector('[data-role], .role, #role, .user-role, .account-type');
                    if(roleNode) {
                        role = roleNode.textContent.trim();
                    } else {
                        let poss = ["admin", "student", "instructor", "developer", "manager"];
                        let all = dom.querySelectorAll('*');
                        for(let n of all) {
                            let t = (n.textContent || "").toLowerCase();
                            for(let p of poss) {
                                if (t.includes(p)) {
                                    role = n.textContent.trim();
                                    break;
                                }
                            }
                            if(role) break;
                        }
                    }

                    if(!name || name.length<3) {
                        let el = findText(dom, 'username') || findText(dom, 'name');
                        if(el) {
                            let t = el.innerText;
                            let m = t.match(/username\W*:?([\w \-]+)/i) || t.match(/name\W*:?([\w \-]+)/i);
                            if (m) {
                                name = m[1].trim();
                            } else if (t.length < 28) {
                                name = t.trim();
                            }
                        }
                    }

                    if((!name || name.length<2) && dom.querySelector('title')) {
                        name = dom.querySelector('title').textContent.trim();
                    }

                    let html = '';
                    if (name) html += '<span class="user-name"><i class="far fa-user"></i> ' + name + '</span>';
                    if (email) html += '<span class="user-email"><i class="far fa-envelope"></i> ' + email + '</span>';
                    if (role) html += '<span class="user-role">' + role + '</span>';

                    if (html) {
                        userBox.innerHTML = html;
                    } else {
                        userBox.textContent = "User info unavailable";
                    }
                })
                .catch(function() {
                    userBox.textContent = "User info unavailable";
                });
        });

        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showStatus('Copied to clipboard!', 1400);
                }, () => {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }
        function fallbackCopy(text) {
            try {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showStatus('Copied!', 1200);
            } catch(e){
                showStatus('Copy failed', 1500, true);
            }
        }
        function showStatus(msg, ms = 1200, error=false) {
            let stat = document.createElement('div');
            stat.style.position = 'fixed';
            stat.style.bottom = '70px';
            stat.style.right = '30px';
            stat.style.background = error ? '#d81b60' : "#302a63";
            stat.style.color = 'white';
            stat.style.padding = '9px 18px';
            stat.style.borderRadius = '7px';
            stat.style.fontWeight = '500';
            stat.style.zIndex = 11000;
            stat.style.boxShadow="0 4px 15px rgba(60,0,70,.11)";
            stat.textContent = msg;
            document.body.appendChild(stat);
            setTimeout(()=>{ stat.remove(); }, ms);
        }

        document.addEventListener('click', function(e) {
            if (e.target.matches('[data-copy-target]')) {
                var input = document.getElementById(e.target.getAttribute('data-copy-target'));
                if (input) {
                    copyToClipboard(input.value || input.innerText);
                }
            }
            if (e.target.matches('#copy-url')) {
                let urlSpan = document.getElementById('url-val');
                copyToClipboard(urlSpan.innerText || urlSpan.textContent);
            }
        });

        document.addEventListener('click', function(e) {
            if (e.target.matches('[data-toggle-pass]')) {
                let inputId = e.target.getAttribute('data-toggle-pass');
                let input = document.getElementById(inputId);
                if (input.type === "password") {
                    input.type = "text";
                    e.target.classList.remove('fa-eye');
                    e.target.classList.add('fa-eye-slash');
                } else {
                    input.type = "password";
                    e.target.classList.remove('fa-eye-slash');
                    e.target.classList.add('fa-eye');
                }
            }
        });
        document.querySelectorAll('[data-toggle-pass]').forEach(function(ic) {
            ic.classList.remove('fa-copy');
            ic.classList.add('fa-eye');
        });

        document.getElementById('btn-open').addEventListener('click', function() {
            var url = document.getElementById('url-val').innerText.trim();
            if (url.length > 10) {
                window.open(url, "_blank", "noopener,noreferrer");
            } else {
                showStatus('No Sandbox URL!', 1500, true);
            }
        });

        document.getElementById('btn-delete').addEventListener('click', function() {
            if (confirm('Are you sure you want to delete this sandbox? This action cannot be undone.')) {
                document.getElementById('btn-open').disabled = true;
                document.getElementById('btn-delete').disabled = true;
                document.getElementById('status-bar').innerHTML = 
                  '<i class="fas fa-exclamation-triangle" style="color:#d81b60"></i> <span><strong>This sandbox has been deleted contact the admin.</strong></span>';
                document.querySelectorAll('.inputs-grid input').forEach(function(inp){ inp.value=""; inp.disabled=true; inp.style.opacity=0.45; });
                document.getElementById('url-val').innerText = "[deleted]";
                showStatus('Sandbox deleted', 1600);
            }
        });

        document.getElementById('help-fab').addEventListener('click',function(){
            document.getElementById('help-modal').style.display = 'flex';
        });

        document.getElementById('help-modal').addEventListener('click', function(e) {
            if (e.target === this) this.style.display = 'none';
        });

        document.getElementById('url-val').addEventListener('click', function(){
            if(document.body.createTextRange) {
                var range = document.body.createTextRange();
                range.moveToElementText(this); range.select();
            } else if(window.getSelection) {
                var selection = window.getSelection(); 
                var range = document.createRange();
                range.selectNodeContents(this);
                selection.removeAllRanges();
                selection.addRange(range);
            }
        });

        document.querySelectorAll('.inputs-grid input').forEach(function(inp){
            inp.addEventListener('click',function(){ this.select(); });
        });

        let audioUnlocked = false;
        document.addEventListener('click', () => {
          if (!audioUnlocked) {
            const audio = document.getElementById('notify-sound');
            audio.play().then(() => {
              audio.pause();
              audio.currentTime = 0;
              audioUnlocked = true;
            }).catch(()=>{});
          }
        });

        Pusher.logToConsole = true;
        const pusher = new Pusher('fe30ee9b4937f15ee2b4', {
          cluster: 'ap2'
        });
        const channel = pusher.subscribe('my-channel');
        channel.bind('my-event', function(data) {
          const box = document.getElementById('notify-box');
          const list = document.getElementById('notify-list');
          const sound = document.getElementById('notify-sound');
          list.innerHTML = '';
          const item = document.createElement('div');
          item.className = 'notify-item';
          item.innerText = data.message || 'New Notification';
          list.appendChild(item);
          box.classList.add('show');
          if (audioUnlocked) {
            sound.currentTime = 0;
            sound.play();
          }
          setTimeout(() => {
            box.classList.remove('show');
          }, 40000);
        });
    </script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MBJM2CCKJ6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MBJM2CCKJ6');
    </script>
</body>
</html>
