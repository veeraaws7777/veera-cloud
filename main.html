<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skills Dashboard </title>
     <link rel="icon" type="image/png" href="https://static.vecteezy.com/system/resources/thumbnails/045/720/728/small_2x/dark-cat-head-free-png.png">
    <style>
        :root {
            --bg-dark: #120d1d;
            --sidebar-bg: #1d152d;
            --card-bg: #271e3d;
            --text-main: #ffffff;
            --text-muted: #a19bb8;
            --accent-purple: #5e46e8;
            --active-pink: #f02d64;
            --search-bg: #251d3a;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-dark); color: var(--text-main); min-height: 100vh; height: 100vh; width: 100vw; }
        .app-container {
            display: flex;
            min-height: 100vh;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: 240px;
            min-width: 240px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            padding: 20px 0;
            border-right: 1px solid #2d2545;
            position: relative;
            z-index: 10;
        }
        .logo { padding: 0 20px 30px; font-weight: 900; font-size: 22px; letter-spacing: 1px; display: flex; align-items: center; }
        .logo::before { content: '‚ñ∂'; margin-right: 8px; color: var(--text-main); }
        .nav-item { padding: 12px 20px; display: flex; align-items: center; cursor: pointer; color: var(--text-muted); font-size: 14px; transition: background 0.2s, color 0.2s, border-left 0.2s, transform 0.08s cubic-bezier(.3,1.35,.2,1), box-shadow 0.2s; border-left: 3px solid transparent; user-select: none; position: relative; overflow: hidden;}
        .nav-item:hover { background: #2d2545; color: white; }
        .nav-item.active { color: white; border-left: 3px solid var(--active-pink); background: linear-gradient(90deg, #32254d 0%, transparent 100%); }
        .nav-item:active {
            transform: scale(0.96);
            background: #403061;
            box-shadow: 0 2px 8px 0 rgba(60,0,120,0.07);
            color: white;
        }
        .nav-click-ripple {
            position: absolute;
            background: rgba(255,255,255,0.18);
            border-radius: 50%;
            pointer-events: none;
            width:100px;height:100px;
            transform: translate(-50%,-50%);
            animation: nav-ripple-anim 0.5s;
            z-index: 1;
            mix-blend-mode: lighten;
        }
        @keyframes nav-ripple-anim {
            to { opacity:0; transform:translate(-50%,-50%) scale(2.5);}
        }

        /* MAIN CONTENT */
        .main-container { flex: 1; display: flex; flex-direction: column; overflow-x: hidden; overflow-y: auto; min-width: 0; background: var(--bg-dark);}
        header {
            min-height: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            background: var(--bg-dark);
            border-bottom: 1px solid #2d2545;
            z-index: 1;
        }
        .search-bar { background: var(--search-bg); border: 1px solid #3d345a; border-radius: 4px; padding: 8px 15px; width: 400px; color: white; transition: border 0.2s; }
        .search-bar:focus { border: 1.5px solid var(--active-pink); outline: none;}
        .top-right { display: flex; align-items: center; gap: 20px; }
        .user-icon { width: 32px; height: 32px; background: var(--active-pink); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; }

        .content { padding: 30px 40px; max-width: 1200px; margin: 0 auto; }
        h2 { font-size: 18px; margin-bottom: 20px; font-weight: 500; }

        /* CONTINUE LEARNING CARD */
        .hero-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            gap: 32px;
            flex-wrap: wrap;
        }
        .hero-info .badge { background: #3d345a; padding: 4px 8px; font-size: 10px; border-radius: 3px; font-weight: bold; }
        .hero-info h3 { font-size: 24px; margin: 15px 0; }
        .btn-resume { background: var(--accent-purple); color: white; border: none; padding: 10px 25px; border-radius: 4px; font-weight: bold; cursor: pointer; margin-right: 15px; transition: transform 0.18s, box-shadow 0.14s;}
        .btn-resume:active { transform: scale(0.97);}
        .remaining { color: var(--text-muted); font-size: 13px; }

        /* SECTION HEADER & GRID */
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .section-header a { color: var(--accent-purple); text-decoration: none; font-size: 14px; }
        .section-header a:hover { text-decoration: underline; }
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
        }

        .video-card {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        .video-card:hover { transform: translateY(-5px) scale(1.03); box-shadow: 0 6px 32px 0 #160f26; }
        .card-thumb { height: 120px; background: #3d345a; position: relative; }
        .card-duration { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); padding: 2px 6px; font-size: 11px; border-radius: 3px; }
        .card-body { padding: 15px; min-height: 84px;}
        .card-type { font-size: 10px; color: var(--text-muted); display: block; margin-bottom: 5px; }
        .card-title { font-size: 14px; font-weight: 500; height: 40px; margin-bottom: 15px; display: block; }
        .card-footer { font-size: 12px; color: var(--text-muted); }

        /* IRIS CHAT WIDGET */
        .iris-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--active-pink);
            width: 50px; height: 50px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            font-weight: bold;
            font-size: 20px;
            z-index: 100;
            transition: transform 0.16s;
        }
        .iris-btn:active { transform: scale(0.97);}
        @media (max-width: 950px) {
            .main-container .content { padding: 24px 12px; }
            .search-bar { width: 250px; }
        }
        @media (max-width: 700px) {
            .app-container { flex-direction: column; }
            .sidebar { width: 100vw; min-width: 0; flex-direction: row; border-right: none; border-bottom: 1px solid #2d2545; overflow-x: auto; }
            .logo { font-size: 18px; padding: 0 10px 12px 10px;}
            .nav-item { padding: 8px 12px; font-size: 13px;}
            .main-container { width: 100vw;}
        }
        @media (max-width: 500px) {
            .main-container .content { padding: 10px 2vw;}
            .search-bar { width: 98vw; min-width: 0; }
            .hero-card { flex-direction: column; gap:16px;}
        }
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 0; padding-bottom: 14px; width: 100%;">
                <div style="background: #221b37; border-radius: 10px; padding: 18px 24px; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; width: 92%; margin-top: 8px;">
                    <img
                        src="https://nareshit.in/wp-content/uploads/2023/02/nareshitechnologies-png-logo.png"
                        alt="Veera Logo"
                        style="display: block; max-width: 180px; width: 100%; height: auto; margin-bottom: 18px;"
                    >
                    <div style="font-size: 20px; font-weight: bold; color: #fff; margin-top: 5px;">
                        Veera <small style="font-size: 18px; color: #eebaff; margin-left: 4px;">Sandbox</small>
                    </div>
                </div>
            </div>
            <style>
                /* Animation for nav items (slide-in and fade effect) */
                @keyframes navSlideIn {
                    from {
                        opacity: 0;
                        transform: translateY(18px) scale(0.98);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0) scale(1);
                    }
                }
                .sidebar-anim-container .nav-item {
                    animation: navSlideIn 0.5s cubic-bezier(0.4,0.2,0.2,1) both;
                }
                /* Stagger animation delay for each nav item */
                .sidebar-anim-container .nav-item:nth-child(1) { animation-delay: 0.05s; }
                .sidebar-anim-container .nav-item:nth-child(2) { animation-delay: 0.1s; }
                .sidebar-anim-container .nav-item:nth-child(3) { animation-delay: 0.15s; }
                .sidebar-anim-container .nav-item:nth-child(4) { animation-delay: 0.2s; }
                .sidebar-anim-container .nav-item:nth-child(5) { animation-delay: 0.25s; }
                /* Optional hover effect for life */
                .nav-item {
                    transition: box-shadow 0.2s, transform 0.2s;
                }
                .nav-item:hover {
                    box-shadow: 0 4px 16px 0 #1d133835, 0 1px 2px 0 #0001;
                    transform: translateY(-1px) scale(1.02);
                    background: #2d2347 !important;
                }
            </style>
            <div class="sidebar-anim-container" style="display: flex; flex-direction: column; align-items: center; width: 100%;">
                <div class="nav-item mouse-anim" data-target="#" style="min-width: 220px; max-width: 350px; width:100%; text-align: center; border-top:2px solid #000; border-bottom:2px solid #000; box-sizing:border-box; padding:10px 0; background: #221b37; margin: 4px 0; position:relative; overflow:hidden;">
                    <span style="font-weight:bold; color:#eaeaed; text-shadow: 0 0 1px #000, 0 1px 1px #221b37;">üè† Home</span>
                </div>
                <div class="nav-item mouse-anim" data-target="error.html" style="min-width: 220px; max-width: 350px; width:100%; text-align: center; border-top:2px solid #000; border-bottom:2px solid #000; box-sizing:border-box; padding:10px 0; background: #221b37; margin: 4px 0; position:relative; overflow:hidden;">
                    <span style="font-weight:bold; color:#eaeaed; text-shadow: 0 0 1px #000, 0 1px 1px #221b37;">üåê Browse all</span>
                </div>
                <div class="nav-item mouse-anim" data-target="error.html" style="min-width: 220px; max-width: 350px; width:100%; text-align: center; border-top:2px solid #000; border-bottom:2px solid #000; box-sizing:border-box; padding:10px 0; background: #221b37; margin: 4px 0; position:relative; overflow:hidden;">
                    <span style="font-weight:bold; color:#eaeaed; text-shadow: 0 0 1px #000, 0 1px 1px #221b37;">üì° Channels</span>
                </div>
                <div class="nav-item mouse-anim" data-target="Certification.html" style="min-width: 220px; max-width: 350px; width:100%; text-align: center; border-top:2px solid #000; border-bottom:2px solid #000; box-sizing:border-box; padding:10px 0; background: #221b37; margin: 4px 0; position:relative; overflow:hidden;">
                    <span style="font-weight:bold; color:#eaeaed; text-shadow: 0 0 1px #000, 0 1px 1px #221b37;">üèÜ Certifications</span>
                </div>
                <div class="nav-item mouse-anim" data-target="hand-on.html" style="min-width: 220px; max-width: 350px; width:100%; text-align: center; border-top:2px solid #000; border-bottom:2px solid #000; box-sizing:border-box; padding:10px 0; background: #221b37; margin: 4px 0; position:relative; overflow:hidden;">
                    <span style="font-weight:bold; color:#eaeaed; text-shadow: 0 0 1px #000, 0 1px 1px #221b37;"> üõ†Ô∏è Hands-on</span>
                </div>
            </div>
            <style>
                /* Mouse-on-it animation for nav items */
                .mouse-anim {
                    cursor: pointer;
                    transition: box-shadow 0.24s cubic-bezier(.37,1.01,.77,.97), 
                                transform 0.23s cubic-bezier(.37,1.01,.77,.97),
                                background 0.16s;
                    box-shadow: none;
                }
                .mouse-anim::after {
                    content: '';
                    display: block;
                    position: absolute;
                    pointer-events: none;
                    left: 50%;
                    top: 50%;
                    width: 0px;
                    height: 0px;
                    background: radial-gradient(circle, #9f7aea55 0%, #221b3700 80%);
                    opacity: 0;
                    transform: translate(-50%, -50%);
                    transition: opacity 0.3s, width 0.35s cubic-bezier(.37,1.01,.77,.97), height 0.35s cubic-bezier(.37,1.01,.77,.97);
                    z-index: 0;
                }
                .mouse-anim:hover {
                    box-shadow: 0 8px 24px 0 #9f7aea35, 0 1px 4px 0 #0001;
                    background: #2d2347 !important;
                    transform: translateY(-3px) scale(1.035) rotate(-0.7deg);
                }
                .mouse-anim:hover::after {
                    opacity: 1;
                    width: 170%;
                    height: 950%;
                }
                .mouse-anim span {
                    position: relative;
                    z-index: 1;
                    transition: color 0.2s;
                }
                .mouse-anim:hover span {
                    color: #ffd6fa;
                    text-shadow: 0 0 5px #b649d3, 0 1px 1px #0004;
                }
            </style>
        </aside>

        <div class="main-container">
            <!--
                Advanced Gemini Search Bar ‚Äì Powered by API Key:
                AIzaSyDa_Vv4DHRntG-cKFPOfAkqd357GV3BcjA
            -->
            <header style="display: flex; justify-content: center; align-items: flex-start; padding-top: 24px; position: relative;">
                <div class="advanced-search-bar-container" style="position: relative; flex: 1; max-width: 600px; min-width: 230px;">
                    <input 
                        type="text" 
                        class="advanced-search-bar"
                        id="gimini-search-input"
                        placeholder="Search for learning content, courses, sandboxes, topics..."
                        aria-label="Search for learning content"
                        autocomplete="off"
                        spellcheck="false"
                    >
                    <span class="advanced-search-icon" aria-hidden="true">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" focusable="false">
                            <circle cx="10" cy="10" r="7.2" stroke="#baa6ea" stroke-width="2"/>
                            <path d="M16.15 16.65l-2.13-2.13" stroke="#baa6ea" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </span>
                    <button 
                        type="button"
                        class="advanced-search-btn"
                        id="gimini-search-btn"
                        title="Start Search"
                        aria-label="Start Search"
                    >
                        <svg width="17" height="17" fill="none" viewBox="0 0 18 18" focusable="false">
                            <circle cx="8" cy="8" r="6" stroke="white" stroke-width="2"/>
                            <path d="M14 14l-2-2" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                    <div class="search-advanced-dropdown">
                        <button class="advanced-dropdown-toggle" title="Advanced Search Filters" aria-haspopup="true" aria-expanded="false">
                            &#9881;
                        </button>
                        <div class="advanced-dropdown-menu" aria-label="Advanced Search Filters">
                            <label><input type="checkbox" class="filter-checkbox" value="Content" checked> Content</label>
                            <label><input type="checkbox" class="filter-checkbox" value="Courses" checked> Courses</label>
                            <label><input type="checkbox" class="filter-checkbox" value="Sandboxes"> Sandboxes</label>
                            <label><input type="checkbox" class="filter-checkbox" value="Topics"> Topics</label>
                        </div>
                    </div>
                </div>
                <img 
                    src="https://static.vecteezy.com/system/resources/thumbnails/045/720/728/small_2x/dark-cat-head-free-png.png" 
                    alt="Dark Cat Icon"
                    loading="lazy"
                    style="position: absolute; top: 0; right: 0; height: 48px; width: 48px; object-fit: contain; z-index: 2; margin: 4px 12px 0 0;"
                >
            </header>
            <style>
                .advanced-search-bar-container {
                    display: flex;
                    align-items: center;
                    position: relative;
                    width: 100%;
                }
                .advanced-search-bar {
                    width: 100%;
                    padding: 13px 115px 13px 45px;
                    border-radius: 28px;
                    background: var(--search-bg, #1d162a);
                    border: none;
                    font-size: 1.12em;
                    color: var(--text-main, #fff);
                    box-shadow: 0 0 0 2px #292043 inset, 0 2px 8px #170e2a40;
                    transition: box-shadow 0.17s, background 0.19s;
                    font-family: inherit;
                }
                .advanced-search-bar:focus {
                    outline: none;
                    box-shadow: 0 0 0 3px #7a5afcaa, 0 2px 8px #3b287580;
                    background: #221c33;
                }
                .advanced-search-bar::placeholder {
                    color: #b3b3ca;
                    opacity: 0.97;
                    letter-spacing: .03em;
                    font-size: 0.96em;
                }
                .advanced-search-icon {
                    position: absolute;
                    left: 15px; top: 50%;
                    transform: translateY(-50%);
                    color: #baa6ea;
                    display: flex; align-items: center; height: 100%;
                    pointer-events: none;
                    z-index: 2;
                }
                .advanced-search-btn {
                    position: absolute;
                    right: 46px;
                    top: 50%;
                    transform: translateY(-50%);
                    background: linear-gradient(135deg, var(--accent-purple, #6749d7) 60%, #916afc 100%);
                    color: #fff;
                    border: none;
                    border-radius: 50%;
                    width: 34px; height: 34px;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    box-shadow: 0 2px 10px #5335db35;
                    cursor: pointer;
                    font-size: 1.18em;
                    transition: background 0.16s, box-shadow 0.13s, transform 0.14s;
                    z-index: 3;
                }
                .advanced-search-btn:active {
                    transform: scale(0.96);
                }
                .advanced-search-btn:hover, .advanced-search-btn:focus {
                    background: linear-gradient(135deg, #845bdd 40%, var(--accent-purple, #6749d7) 100%);
                    box-shadow: 0 4px 18px #7d58ea50;
                }
                .search-advanced-dropdown {
                    position: absolute;
                    right: 8px;
                    top: 50%;
                    transform: translateY(-50%);
                    z-index: 10;
                    display: flex;
                    align-items: center;
                }
                .advanced-dropdown-toggle {
                    background: #1d1530;
                    color: #baa6ea;
                    border: none;
                    border-radius: 50%;
                    width: 30px; height: 30px;
                    font-size: 1.2em;
                    cursor: pointer;
                    transition: background 0.16s, color 0.15s;
                    margin-left: 8px;
                    box-shadow: 0 1px 6px #2f216640;
                    display: flex; align-items: center; justify-content: center;
                }
                .advanced-dropdown-toggle:focus,
                .advanced-dropdown-toggle:hover {
                    background: var(--accent-purple, #644ee5);
                    color: #fdefff;
                }
                .advanced-dropdown-menu {
                    display: none;
                    position: absolute;
                    right: 0;
                    top: 40px;
                    background: #251c39;
                    border-radius: 8px;
                    box-shadow: 0 4px 20px #22213f14, 0 1.5px 4px #784af591;
                    padding: 12px 18px;
                    min-width: 155px;
                    font-size: 1.04em;
                    z-index: 99;
                }
                .advanced-dropdown-toggle.active + .advanced-dropdown-menu,
                .advanced-dropdown-menu:focus-within {
                    display: block;
                }
                .advanced-dropdown-menu label {
                    display: block;
                    padding: 5px 0;
                    color: #eaeaed;
                    cursor: pointer;
                    font-size: 1em;
                }
                .advanced-dropdown-menu input[type="checkbox"] {
                    margin-right: 8px;
                    accent-color: #7c5aed;
                }
                @media (max-width: 600px) {
                    .advanced-search-bar-container {
                        max-width: 99vw;
                        min-width: 0;
                    }
                }
                .gimini-search-results {
                    margin: 20px 0 18px 0;
                    background: #251e38;
                    border-radius: 12px;
                    padding: 19px 24px;
                    color: #eae3ff;
                    font-size: 1.09em;
                    box-shadow: 0 2px 12px #12072917;
                    min-height: 48px;
                    position: relative;
                    overflow-x: auto;
                    word-break: break-word;
                    border-left: 5px solid #7a5afc30;
                }
                .gimini-search-loading {
                    color: #afa1e3;
                    font-size: 1em;
                    display: flex;
                    align-items: center;
                    gap: 7px;
                }
                .gimini-search-loading .spinner {
                    display: inline-block;
                    width: 18px;
                    height: 18px;
                    border: 2.4px solid #c9b8f0;
                    border-top: 2.4px solid #644ee5;
                    border-radius: 50%;
                    animation: spin 0.95s linear infinite;
                }
                @keyframes spin {
                    100% { transform: rotate(360deg); }
                }
                .gimini-search-error {
                    color: #f26d94;
                    font-weight: bold;
                    font-size: 1em;
                }
                .gimini-search-actions {
                    margin-top: 9px;
                    display: flex;
                    gap: 10px;
                }
                .gimini-search-actions button {
                    background: #281d3e;
                    color: #b9a8e8;
                    border: none;
                    border-radius: 6px;
                    padding: 6px 14px;
                    font-size: 0.98em;
                    cursor: pointer;
                    transition: background 0.14s, color 0.13s;
                }
                .gimini-search-actions button:hover {
                    background: #7053fa;
                    color: #fff;
                }
            </style>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    // Dropdown accessibility logic
                    const toggle = document.querySelector('.advanced-dropdown-toggle');
                    const menu = document.querySelector('.advanced-dropdown-menu');
                    if (toggle && menu) {
                        let toggled = false;
                        toggle.addEventListener('click', function(e) {
                            e.stopPropagation();
                            toggled = !toggle.classList.contains('active');
                            document.querySelectorAll('.advanced-dropdown-toggle').forEach(btn => btn.classList.remove('active'));
                            if (toggled) {
                                toggle.classList.add('active');
                                menu.style.display = "block";
                                toggle.setAttribute('aria-expanded', 'true');
                            } else {
                                toggle.classList.remove('active');
                                menu.style.display = "none";
                                toggle.setAttribute('aria-expanded', 'false');
                            }
                        });
                        document.addEventListener('mousedown', function(event) {
                            if (!menu.contains(event.target) && event.target !== toggle) {
                                toggle.classList.remove('active');
                                menu.style.display = "none";
                                toggle.setAttribute('aria-expanded', 'false');
                            }
                        });
                    }

                    // Advanced Gemini API Search Integration

                    const searchBtn = document.getElementById('gimini-search-btn');
                    const searchInput = document.getElementById('gimini-search-input');
                    const filters = Array.from(document.querySelectorAll('.filter-checkbox'));
                    const contentArea = document.querySelector('.content-area');
                    
                    // Results display area
                    let resultDiv = document.createElement('div');
                    resultDiv.className = 'gimini-search-results';
                    resultDiv.style.display = "none";
                    contentArea.parentNode.insertBefore(resultDiv, contentArea);

                    // Search state
                    let lastQuery = '';
                    let lastFilters = [];
                    
                    // Utility for escape
                    function escapeHtml(str) {
                        return String(str)
                            .replace(/&/g, "&amp;")
                            .replace(/</g, "&lt;")
                            .replace(/>/g, "&gt;")
                            .replace(/"/g, "&quot;")
                            .replace(/'/g, "&#039;");
                    }
                    // Text formatting
                    function formatParagraphs(text) {
                        // Auto paragraph formatting for AI output
                        return text
                            .split(/\n{2,}/)
                            .map(t => `<p style="margin:10px 0;">${t.replace(/\n/g,'<br>')}</p>`)
                            .join('');
                    }

                    // Compose advanced prompt for Gemini
                    function buildPrompt(query, chosenFilters) {
                        if (!chosenFilters.length) return `Learning search: ${query}`;
                        return `Learning search: ${query}. Only include results related to: ${chosenFilters.join(", ")}. Format results with clarity for a technical user.`;
                    }
                    // Spinner for loading indication
                    function spinnerSVG() {
                        return `<span class="spinner" aria-hidden="true"></span>`;
                    }

                    // Handle advanced filter changes
                    function getActiveFilters() {
                        return filters.filter(c => c.checked).map(c => c.value);
                    }
                    filters.forEach(checkbox => {
                        checkbox.addEventListener('change', () => {
                            if (lastQuery) {
                                doGiminiSearch(lastQuery, true); // refresh results if a query already exists
                            }
                        });
                    });

                    function showActions(query, filtersArr) {
                        return `<div class="gimini-search-actions">
                            <button type="button" onclick="navigator.clipboard.writeText('${escapeHtml(query)}')" title="Copy Query">Copy Query</button>
                            <button type="button" onclick="window.dispatchEvent(new CustomEvent('gimini-clear-search'))" title="Clear Results">Clear</button>
                        </div>`;
                    }
                    window.addEventListener('gimini-clear-search', function() {
                        resultDiv.innerHTML = "";
                        resultDiv.style.display = "none";
                        searchInput.value = "";
                        searchInput.focus();
                    });

                    // Main search workflow
                    async function doGiminiSearch(optionalQuery, triggeredByFilters = false) {
                        const query = typeof optionalQuery === "string" ? optionalQuery : searchInput.value.trim();
                        const chosenFilters = getActiveFilters();
                        lastQuery = query;
                        lastFilters = chosenFilters;

                        if (!query) return;

                        // API Key for demonstration purposes only
                        const apiKey = "AIzaSyDa_Vv4DHRntG-cKFPOfAkqd357GV3BcjA";
                        const endpoint = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=" + apiKey;
                        resultDiv.style.display = 'block';
                        resultDiv.innerHTML = `<span class="gimini-search-loading">${spinnerSVG()}Loading results for "<b>${escapeHtml(query)}</b>"${chosenFilters.length ? " with filters: <i>" + chosenFilters.join(', ') + "</i>" : ""}...</span>`;

                        const payload = {
                            contents: [{
                                parts: [{ text: buildPrompt(query, chosenFilters) }]
                            }]
                        };

                        try {
                            const res = await fetch(endpoint, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                            if (!res.ok) {
                                throw new Error(`HTTP ${res.status}`);
                            }
                            const data = await res.json();

                            let text = '';
                            if (data && data.candidates && data.candidates.length > 0) {
                                text = data.candidates[0].content.parts[0].text;
                            } else if (data && data.candidates && data.candidates.length) {
                                text = data.candidates[0].output || '[No output]';
                            } else {
                                text = '[No results found]';
                            }

                            resultDiv.innerHTML = `
                                <div>
                                    <span style="color:#c9b8f0;font-size:1.07em;font-weight:600;letter-spacing:0.03em;">
                                        Gemini Results${chosenFilters.length ? ' [' + chosenFilters.join(', ') + ']' : ''}:
                                    </span>
                                    <br>${formatParagraphs(escapeHtml(text))}
                                    ${showActions(query, chosenFilters)}
                                </div>`;
                        } catch (err) {
                            resultDiv.innerHTML = `<span class="gimini-search-error">Failed to fetch from Gemini API. ${(err && err.message)||''}</span>
                                ${showActions(query, chosenFilters)}`;
                        }
                    }

                    // Enter key and search button
                    searchInput.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter') {
                            doGiminiSearch();
                        }
                    });
                    searchBtn.addEventListener('click', function() {
                        doGiminiSearch();
                    });

                    // Support submitting via Ctrl+Enter for power users
                    searchInput.addEventListener('keydown', function(e){
                        if (e.ctrlKey && e.key.toLowerCase() === "enter") {
                            doGiminiSearch();
                        }
                    });

                    // Autofocus the search on page load for quick access
                    setTimeout(() => { searchInput.focus(); }, 360);

                });
            </script>
            <section class="content-area" style="flex:1; padding: 0 32px;"></section>
            
        </div>

        <div class="iris-btn" id="iris-btn">?</div>
        <div id="iris-popup" style="display:none; position:fixed; bottom:80px; right:20px; background:#241a36; color:white; border-radius:8px; box-shadow:0 4px 20px #140c22a2; padding:22px 25px; z-index:102; width:305px; max-width:95vw; font-size:15px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <span style="font-weight:bold; font-size:16px;">Welcome!</span>
                <button id="iris-close" style="background:none;border:none;color:#fff;font-size:18px;cursor:pointer;line-height:1;">&times;</button>
            </div>
            <div>
                Are you ready to use the cloud services: <b>AWS</b>, <b>Azure</b>, <b>GCP</b>?
            </div>
        </div>
        <script>
            const irisBtn = document.getElementById('iris-btn');
            const irisPopup = document.getElementById('iris-popup');
            const irisClose = document.getElementById('iris-close');

            // Show the popup automatically after 1 second
            setTimeout(() => {
                irisPopup.style.display = 'block';
            }, 1000);

            irisBtn.addEventListener('click', () => {
                irisPopup.style.display = 'block';
            });

            irisClose.addEventListener('click', () => {
                irisPopup.style.display = 'none';
            });

            // Optional: close popup clicking outside of it
            document.addEventListener('mousedown', function(event) {
                if (irisPopup.style.display === 'block'
                    && !irisPopup.contains(event.target)
                    && event.target !== irisBtn) {
                    irisPopup.style.display = 'none';
                }
            });
        </script>
        
    </div>
    <script>
        // Sidebar navigation logic
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                const target = this.getAttribute('data-target');
                if (target) {
                    window.location.href = target;
                }
            });
        });
        // Ripple effect on navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function(e) {
                let ripple = document.createElement('span');
                ripple.className = 'nav-click-ripple';
                ripple.style.left = (e.clientX - item.getBoundingClientRect().left) + 'px';
                ripple.style.top = (e.clientY - item.getBoundingClientRect().top) + 'px';
                item.appendChild(ripple);
                setTimeout(() => { ripple.remove(); }, 500);
            });
        });
    </script>
</body>
</html>
